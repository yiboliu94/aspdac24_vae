\section{Introduction}
\label{sec:intro}
Electromigration (EM) is a physical phenomenon that the metal atoms migrate along the direction of several driving forces, such as the applied electrical field. 
With the complexity of modern very large scale integration (VLSI) designs, EM remains the top reliability failure mechanism for copper-based interconnects in all the sub-nanometer technologies.
As a consequence of the EM effect, when the hydrostatic stress inside the metal wire reaches the critical level, resistance may varies over time during the migration, and the conducting electrons at the cathode and anode will form a void and a hillock.
The EM crisis becomes even worse as technology advances to smaller manufacturing processes. 
%The International Roadmap for Devices and Systems (IRDS) \cite{IRDS20} predicts that the allowable current density will continue to decrease due to EM, while the required current density to drive the gates will continue to increase. Developing and employing more accurate EM models and less conservative EM sign-off and assessment techniques for EM-aware designs and runtime management is critical. 

On chip power distribution networks (PDN), as shown in Fig.~\ref{fig:pgimage}, is a mesh-structured network which provides power to transistors from top metals, are usually vulnerable to the EM-induced failures, since the current on the PDN are large and unidirectional. In order to design robust PDN, designers have to properly size the PDN wires to meet the area and IR drop requirement. This task is changeling as the wires resistance may change along the time due to the EM effect, resulting in IR drops go blow the threshold after years of aging effect.

\begin{figure}[htp]
	\centering
	\subfigure[]{
		\includegraphics[width=0.4\columnwidth]{./figs/icc2pg.eps}
		\label{fig:icc2pg}}
	\subfigure[]{
		\includegraphics[width=0.48\columnwidth]{./figs/genpg.eps}
		\label{fig:genpg}}
	\caption{(a) Power and ground networks of Cortex-M0 DesignStart; (b) Voltage drop map of the power network of (a).}
	\label{fig:pgimage}
\end{figure}


Power distribution networks (PDN) provide power to transistors from top metals on a chip. They have a direct impact on chip performance and reliability. But PDNs are usually vulnerable to the EM-induced failures, as the current densities on the PDN are large and unidirectional. In order to design robust PDN, designers have to properly size the wires to meet the area and IR drop requirement. Many research works have been investigated in the past based on nonlinear or sequence of linear programming (SLP) methods~\cite{ChBr:TCAD'88,DuMa:DAC'89,Tan:DAC'99,Wang:TCAD'05,ZhouSun:TVLSI'19, Sukharev:2019pg,ZhouYu:ASPDAC'20,ZhouJin:ICCAD'20}.  Recently Zhou {\it et al.}~\cite{ZhouSun:TVLSI'19,ZhouChen:Integration'21} proposed a power grid network sizing method based on a multi-segment EM immortality check criteria.However, the EM immortality-constrained optimization is too conservative as it requires all the interconnect trees to be immortal, i.e., void growth is not allowed.  To further mitigate this issue, Moudallal {\it et al.}~\cite{Sukharev:2019pg} proposed to directly consider EM-induced IR drops instead of EM constraints on the time-varying power grid networks. It can consider post-voiding resistance change of wires based on finite difference analysis of EM-induced stress in multi-segment wires, and the resulting nonlinear problem is solved by applying successive linear programming. This method, however, still suffer high computational costs as the sensitivities of those violating nodes need to be computed by solving the circuit matrices. Recently Zhou {\it et al.}~\cite{ZhouJin:ICCAD'20, HanLiu:TCAD'22-23} proposed a conjugate gradient-based localized EM-aware IR drop fix for power grid networks. The optimization is carried out based on the sensitivities method in which the sensitivities were computed by the CGAN-based deep neural network (DNN) modeling method called {\it GridNet}.

% This computation workload of matrices construction and matrices solving increases polynomially as the size of the power grid increases. Also, the scalability of SLP-based method is quite limited when the number of power grid violations increase, since the optimization flow has to solve more sensitivity matrices.

% Zhou {\it et al.}~\cite{ZhouSun:TVLSI'19,ZhouChen:Integration'21} proposed a power grid network sizing method based on a multi-segment EM immortality check criteria. Moudallal {\it et al.}~\cite{Sukharev:2019pg} proposed to directly consider EM-induced IR drops instead of EM constraints on the time-varying power grid networks. It can consider post-voiding resistance change of wires based on finite difference analysis of EM-induced stress in multi-segment wires, and solve the resulting nonlinear problem by applying successive linear programming. This method, however, suffers high computational costs when the size of the power grid increase, as the sensitivity matrices construction solving workload scales up polynomially.
   
Recently, variational autoencoder (VAE)~\cite{Diederik:arxiv'22} was proposed to for generative application. It is based on the autoencoder structures, which is mainly for data compression via latent space. Compared to autoencoder, the encoder of VAE outputs parameters of a pre-defined distribution in the latent space for every input. Furthermore, it introduce more regulation in the cost function so that the resulting latent distribution to be a normal distribution, which leads to more reliable generation of new data. It has been used for generative guided analog routing recently~\cite{Zhu:ICCAD'19}.
% gained traction as it has better interpretability of latent space, which provides them with a robust mathematical grounding and better generated result in some scenarios. Compared to the original encoder-decoder structure, VAE model improves the interpretability of latent space by encoding the input as a probabilistic distribution instead of a deterministic value.
% There are already VAE applications in the EDA field, such as Zhu {\it et al.} \cite{Zhu:ICCAD'19} adopted VAE for analog routing paradigm.
In this way, we explore the genarive capability of VAE for modeling the EM-aware IR drop of power grid networks. On top of this VAE-based model, we further developed VAE-accelerated gradient-based EM-aware IR drop failure fixing method for on-chip power grid design. Our key contributions are summarized as follows:

\begin{itemlist}
\item First, we propose a VAE-based deep neural network models to full-chip model EM-aware IR drop obtained from the numerical full-chip EM-aware IR drop analysis tool.  Compared with the latest generative advaersairal network (GAN) based model~\cite{ZhouJin:ICCAD'20}, the new VAE model can lead to 40$\%$ reduction in RMSE based on our synthesized power grid benchmark circuits.

\item Second, on top of the new VAE based EM-aware IR drop models, we explore its differential nature to fast compute the sensivity of cost functions with respect to the wire width. This lead to accelerated power grid wire sizing method to ensure the EM lifetime of the chip based on sequence of linearing program optimization framework. Experimental results on a number of synthesized power grid benchmarks from ARM Cortex-M0 processor designs show that the proposed method can provide up to $90$X speedup over the existing analytical matrix solving-based SLP method ~\cite{Sukharev:2019pg}.
 
\end{itemlist}

The rest of the paper is organized as follows: Section~\ref{sec:related} reviews the related preliminary works on the EM-induced IR drop analysis and current EM-aware power grid optimization strategy. Section~\ref{sec:strategy} introduces the VAE-based EM-aware IR drop prediction method. Experiment setup, numerical results, as long as analysis and discussions are summarized in Section~\ref{sec:results}.  Section~\ref{sec:conclusion} concludes the paper.